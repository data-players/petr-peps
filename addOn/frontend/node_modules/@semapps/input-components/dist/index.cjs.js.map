{"version":3,"file":"index.cjs.js","sources":["../src/ImageInput.js","../src/OptionRenderer.js","../src/ReferenceInput.js","../src/MultiLinesInput.js","../src/MultiServerAutocompleteArrayInput.js","../src/MultiServerAutocompleteInput.js","../src/ReferenceArrayInput.js"],"sourcesContent":["import React from 'react';\nimport { ImageInput as RaImageInput } from 'react-admin';\n\n// Since we overwrite FileInput default parse, we must transform the file\n// See https://github.com/marmelab/react-admin/blob/2d6a1982981b0f1882e52dd1a974a60eef333e59/packages/ra-ui-materialui/src/input/FileInput.tsx#L57\nconst transformFile = file => {\n  const preview = URL.createObjectURL(file);\n  return ({\n    rawFile: file,\n    src: preview,\n    title: file.name,\n  });\n};\n\nconst format = v => {\n  if (typeof v === 'string') {\n    return ({ src: v });\n  } else if ( Array.isArray(v) ) {\n    return v.map(e => typeof e === 'string' ? { src: e } : e);\n  } else {\n    return v;\n  }\n}\n\nconst parse = v => {\n  if (v instanceof File) {\n    return transformFile(v);\n  } else if (v && v.src && !v.rawFile) {\n    return v.src;\n  } else if (Array.isArray(v)) {\n    return v.map(e => parse(e));\n  } else {\n    return v;\n  }\n}\n\nconst ImageInput = (props) => (\n  <RaImageInput {...props} format={format} parse={parse} />\n);\n\nexport default ImageInput;\n","import React from 'react';\nimport { useRecordContext } from 'react-admin';\n\nconst OptionRenderer = ({ optionText, dataServers }) => {\n  const record = useRecordContext();    \n  const server = dataServers && Object.values(dataServers).find(server => record.id.startsWith(server.baseUrl));\n  return (\n    <span>\n      {record[optionText]}\n      {server && (\n        <em className=\"serverName\" style={{ color: 'grey' }}>\n          &nbsp;({server.name})\n        </em>\n      )}\n    </span>\n  );\n};\n\nexport default OptionRenderer;\n","import React from 'react';\nimport { ReferenceInput as RaReferenceInput } from 'react-admin';\n\nconst format = value => {\n  // If there is no value, return immediately\n  if (!value) return value;\n  // If the value is an object with an @id field, return the uri\n  return typeof value === 'object' ? value.id || value['@id'] : value;\n};\n\nconst ReferenceInput = ({ children, ...rest }) => {\n  const child = React.Children.only(children);\n  return (\n    <RaReferenceInput {...rest}>\n      {React.cloneElement(child, { format })}\n    </RaReferenceInput>\n  );\n};\n\nexport default ReferenceInput;\n","import React from 'react';\nimport { TextInput } from 'react-admin';\n\nconst MultiLinesInput = props => (\n  <TextInput\n    multiline\n    minRows={2}\n    format={value => (value ? (Array.isArray(value) ? value.join('\\n') : value) : '')}\n    parse={value => value.split(/\\r?\\n/)}\n    {...props}\n  />\n);\n\nexport default MultiLinesInput;\n","import React, { useCallback } from 'react';\nimport { AutocompleteArrayInput } from 'react-admin';\nimport { useDataServers } from '@semapps/semantic-data-provider';\nimport OptionRenderer from './OptionRenderer';\n\nconst MultiServerAutocompleteArrayInput = ({ optionText, ...rest }) => {\n  const dataServers = useDataServers();\n  const matchSuggestion = useCallback(\n    (filterValue, choice) => choice[optionText].toLowerCase().match(filterValue.toLowerCase()),\n    [optionText]\n  );\n  return (\n    <AutocompleteArrayInput\n      matchSuggestion={matchSuggestion}\n      optionText={<OptionRenderer optionText={optionText} dataServers={dataServers} />}\n      inputText={choice => choice[optionText]}\n      {...rest}\n    />\n  );\n};\n\nexport default MultiServerAutocompleteArrayInput;\n","import React, { useCallback } from 'react';\nimport { AutocompleteInput } from 'react-admin';\nimport { useDataServers } from '@semapps/semantic-data-provider';\n\nconst MultiServerAutocompleteInput = ({ optionText, ...rest }) => {\n  const dataServers = useDataServers();\n  // We cannot use OptionRenderer like MultiServerAutocompleteArrayInput because there is a bug with AutocompleteInput\n  const optionTextWithServerName = useCallback(\n    record => {\n      if (record && dataServers) {\n        const server = Object.values(dataServers).find(server => record.id.startsWith(server.baseUrl));\n        return record[optionText] + (server ? ` (${server.name})` : '');\n      }\n    },\n    [optionText, dataServers]\n  );\n  return <AutocompleteInput optionText={optionTextWithServerName} {...rest} />;\n};\n\nexport default MultiServerAutocompleteInput;\n","import React, { useEffect } from 'react';\nimport { ReferenceArrayInput as RaReferenceArrayInput } from 'react-admin';\nimport { useController } from 'react-hook-form';\n\nconst ReferenceArrayInput = props => {\n  const { field: { value, onChange }} = useController({ name: props.source });\n\n  useEffect(() => {\n    if (value && !Array.isArray(value)) {\n      onChange([value]);\n    }\n  }, [value, onChange]);\n\n  // Wait for change to be effective before rendering component\n  // Otherwise it will be wrongly initialized and it won't work\n  if (value && !Array.isArray(value)) return null;\n\n  return <RaReferenceArrayInput {...props} />;\n};\n\nexport default ReferenceArrayInput;"],"names":["format","v","src","Array","isArray","map","e","parse","File","rawFile","file","URL","createObjectURL","title","name","OptionRenderer","_ref","optionText","dataServers","record","useRecordContext","server","Object","values","find","id","startsWith","baseUrl","React","createElement","className","style","color","value","_typeof","props","RaImageInput","_extends","TextInput","multiline","minRows","join","split","rest","_objectWithoutProperties","_excluded","useDataServers","matchSuggestion","useCallback","filterValue","choice","toLowerCase","match","AutocompleteArrayInput","inputText","optionTextWithServerName","AutocompleteInput","_useController$field","useController","source","field","onChange","useEffect","RaReferenceArrayInput","ReferenceArrayInput","children","child","Children","only","RaReferenceInput","ReferenceInput","cloneElement"],"mappings":"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"}